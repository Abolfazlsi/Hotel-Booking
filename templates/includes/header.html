<!-- Top Header -->
{% load static %}

{% if messages %}
    {% for message in messages %}
        <div class="modal-container" data-message="{{ message }}" data-type="{{ message.tags }}">
            <div class="modal-item">
                <div class="modal-icon">
                    <!-- Icons will be dynamically added via JavaScript -->
                </div>
                <div class="modal-content">
                    <span class="modal-message-{{ message.tags }}">{{ message }}</span>
                </div>
                <button class="modal-close">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
        </div>
    {% endfor %}
{% endif %}

<!-- Loading Screen -->
<div class="loader" id="loader">
    <div class="text-center">
        <div class="loader-spinner"></div>
        <h4 class="mt-4 fs-5 fw-semibold text-primary-custom">در حال بارگذاری...</h4>
    </div>
</div>

<div class="top-header" dir="rtl">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-6">
                <div class="phone-number">
                    <i class="fa fa-phone"></i>
                    <span>۰۲۱-۳۳۲۵۶۷۸</span>
                    <span class="me-3">منتظر نظرات شما هستیم</span>
                </div>
            </div>
            <div class="col-md-6 text-start">
                <span class="me-3">رزرواسیون هتل ها</span>
            </div>
        </div>
    </div>
</div>

<!-- Main Header -->
<header class="main-header" dir="rtl">
    <div class="container">
        <nav class="navbar navbar-expand-lg">
            <div class="d-flex align-items-center">
                <a href="





                        {% if not request.user.is_authenticated %}{% url "accounts:signin-signup" %}{% else %}#{% endif %}">
                    <div class="user-account me-3">
                        <i class="fa fa-user"></i>
                    </div>
                </a>
                <!-- From Uiverse.io by RiccardoRapelli -->
                <!-- From Uiverse.io by alexruix -->
                <label class="switch">
                    <input type="checkbox">
                    <span class="slider"></span>
                </label>

            </div>
            <div class="profile-content">
                <ul class="profile-content__ul">
                    <div class="profile-content__li">
                        <a href="{% url "accounts:user_profile" %}" style="color: #000000">
                            <li>پروفایل</li>
                        </a>
                    </div>
                    <div class="profile-content__li">
                        <li>تاریخچه رزرو</li>
                    </div>
                    <span style="opacity: 0.2">__________________</span>
                    <div class="profile-content__li logout">
                        <a href="{% url 'accounts:logout' %}" style="color: #000000">
                            <li>خروج</li>
                        </a>
                    </div>
                </ul>
            </div>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link {% if request.resolver_match.url_name == "home" %}active{% endif %}"
                           href="{% url 'hotels:home' %}">
                            <i class="fa fa-home me-2"></i>
                            صفحه اصلی
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if request.resolver_match.url_name == "rooms_list" %}active{% endif %}"
                           href="{% url 'hotels:rooms_list' %}">
                            <i class="fa fa-bed me-2"></i>
                            اتاق ها
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="index.html#services">
                            <i class="fa fa-book me-2"></i>
                            درباره ما
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html#services">
                            <i class="fa fa-phone me-2"></i>
                            تماس با ما
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="index.html#services">
                            <i class="fa fa-star"></i>
                            خدمات
                        </a>
                    </li>
                    <li class="nav-item" style="margin-left: 1rem;">
                        <a class="nav-link" href="index.html#reviews">
                            <i class="fa fa-comments me-2"></i>
                            نظرات کاربران
                        </a>
                    </li>


                </ul>
            </div>
            <a href="{% url "hotels:home" %}">
                <div class="logo">
                    <div class="logo-text">هتل</div>
                    <div class="logo-icon">
                        <i class="fa fa-building"></i>
                    </div>
                </div>
            </a>

        </nav>
    </div>
</header>

<script>
    const accountIcon = document.querySelector(".user-account");
    const profileContent = document.querySelector(".profile-content");
    let profileContentFlag = false;

    {% if not request.user.is_authenticated %}
        accountIcon.addEventListener("mouseenter", () => {
            accountIcon.className = "user-account user-out me-3";
            accountIcon.innerHTML = "";
            accountIcon.innerHTML = "<div class='signup-text'><p>ثبت نام / ورود</p></div>";
        });

        accountIcon.addEventListener("mouseleave", () => {
            accountIcon.className = "user-account me-3";
            accountIcon.innerHTML = "";
            accountIcon.innerHTML = '<i class="fa fa-user"></i>';
        });
    {% else %}
        accountIcon.addEventListener("click", (event) => {
            event.preventDefault(); // جلوگیری از رفتار پیش‌فرض لینک
            if (profileContentFlag) {
                profileContent.classList.remove("user-login");
                profileContentFlag = false;
            } else {
                profileContent.classList.add("user-login");
                profileContentFlag = true;
            }
        });


        document.addEventListener("click", (event) => {
            if (!accountIcon.contains(event.target) && !profileContent.contains(event.target)) {
                profileContent.classList.remove("user-login");
                profileContentFlag = false;
            }
        });
    {% endif %}
    document.addEventListener('DOMContentLoaded', function () {
        const modals = document.querySelectorAll('.modal-container');

        // Icon definitions for different message types
        const icons = {
            success: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20,6 9,17 4,12"></polyline>
                  </svg>`,
            error: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="15" y1="9" x2="9" y2="15"></line>
                  <line x1="9" y1="9" x2="15" y2="15"></line>
                </svg>`,
            warning: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path>
                    <line x1="12" y1="9" x2="12" y2="13"></line>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                  </svg>`,
            info: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                 <circle cx="12" cy="12" r="10"></circle>
                 <line x1="12" y1="16" x2="12" y2="12"></line>
                 <line x1="12" y1="8" x2="12.01" y2="8"></line>
               </svg>`
        };

        modals.forEach(modal => {
            // Apply class based on message type
            const messageType = modal.getAttribute('data-type');
            if (messageType && icons[messageType]) {
                modal.classList.add(messageType);

                // Add appropriate icon
                const iconContainer = modal.querySelector('.modal-icon');
                if (iconContainer) {
                    iconContainer.innerHTML = icons[messageType];
                }
            } else {
                // Default to info if no type specified
                modal.classList.add('info');
                const iconContainer = modal.querySelector('.modal-icon');
                if (iconContainer) {
                    iconContainer.innerHTML = icons.info;
                }
            }

            // Show modal with animation

            setTimeout(() => {
                modal.classList.add('show');
            }, 100);

            // Auto-dismiss after 5 seconds
            const dismissTimer = setTimeout(() => {
                dismissModal(modal);
            }, 5000);
            // Manual close functionality
            const closeButton = modal.querySelector('.modal-close');
            if (closeButton) {
                closeButton.addEventListener('click', () => {
                    clearTimeout(dismissTimer);
                    dismissModal(modal);
                });
            }

            // Click outside to dismiss (optional)
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    clearTimeout(dismissTimer);
                    dismissModal(modal);
                }
            });
        });

        function dismissModal(modal) {
            modal.classList.remove('show');
            modal.classList.add('hide');

            setTimeout(() => {
                if (modal.parentNode) {
                    modal.remove();
                }
            }, 400);
        }

        // Add keyboard support (ESC to close)
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const visibleModals = document.querySelectorAll('.modal-container.show');
                visibleModals.forEach(modal => {
                    dismissModal(modal);
                });
            }
        });
    });
</script>

